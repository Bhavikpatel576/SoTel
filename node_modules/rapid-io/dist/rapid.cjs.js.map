{"version":3,"file":"rapid.cjs.js","sources":["../src/websocket.js","../src/utils/on.js","../src/utils/jsonparse.js","../src/utils/jsonprune.js","../src/transport.js","../src/utils/listen.js","../src/subscription.js","../src/protocol/ack.js","../src/protocol/con.js","../src/protocol/rec.js","../src/protocol/dis.js","../src/protocol/mut.js","../src/protocol/mer.js","../src/protocol/del.js","../src/protocol/ftc.js","../src/protocol/sub.js","../src/protocol/uns.js","../src/protocol/auth.js","../src/protocol/deauth.js","../src/protocol/sub-ch.js","../src/protocol/uns-ch.js","../src/protocol/pub.js","../src/protocol/nop.js","../src/protocol/index.js","../src/utils/is-empty.js","../src/channels/channel.js","../src/channels/channels.js","../src/fetch.js","../src/utils/timer.js","../src/errors.js","../src/connection.js","../src/document.js","../src/utils/check-id.js","../src/collection.js","../src/channel.js","../src/utils/once.js","../src/rapid.js","../src/index.js"],"sourcesContent":["import Emitter from 'component-emitter'\nimport debug from 'debug'\nimport NodeWebSocket from 'ws'\n\nconst BrowserWebSocket = global.WebSocket\n\nconst logger = debug('rapid:ws')\n\nexport default class WebSocket extends Emitter {\n  constructor(url, opts = {}) {\n    super()\n    this.url = url\n    this.perMessageDeflate = opts.perMessageDeflate || false\n    this.protocols = opts.protocols || null\n    this.isUsingBrowserWebSocket = Boolean(BrowserWebSocket)\n    this.open()\n  }\n\n  open() {\n    const { url, protocols, isUsingBrowserWebSocket } = this\n    const wsUrl = `wss://${url}`\n\n    const opts = {\n      perMessageDeflate: this.perMessageDeflate\n      // more node specific options like SSL etc\n    }\n\n    try {\n      if (isUsingBrowserWebSocket) {\n        this.ws = new BrowserWebSocket(wsUrl)\n      } else {\n        this.ws = new NodeWebSocket(wsUrl, protocols, opts)\n      }\n    } catch (err) {\n      this.emit('error', err)\n    }\n\n    this.addEventListeners()\n  }\n\n  addEventListeners() {\n    this.ws.onopen = () => this.emit('open')\n    this.ws.onmessage = event => this.emit('message', event.data)\n    this.ws.onclose = () => this.emit('close')\n    this.ws.onerror = err => this.emit('error', err)\n  }\n\n  send(message) {\n    if (this.ws.readyState !== this.ws.OPEN) {\n      throw new Error('WebSocket is not open')\n    }\n\n    try {\n      this.ws.send(JSON.stringify(message))\n    } catch (error) {\n      logger(\n        'WebSocket was not able to send data, becase it has been already closed.'\n      )\n    }\n  }\n\n  close() {\n    if (\n      typeof this.ws !== 'undefined' &&\n      (this.ws.readyState === this.ws.CONNECTING ||\n        this.readyState === this.ws.OPEN)\n    ) {\n      this.ws.close()\n    }\n  }\n\n  get CONNECTING() {\n    return 0\n  }\n  get OPEN() {\n    return 1\n  }\n  get CLOSING() {\n    return 2\n  }\n  get CLOSED() {\n    return 3\n  }\n  get readyState() {\n    return this.ws.readyState\n  }\n}\n","/**\n * Event listener helper\n * @param {EventEmitter} emitter source\n * @param {String} event listen\n * @param {Function} fn callback\n * @return {object} object with a 'off' method to remove listener\n */\n\nexport default (emitter, event, fn) => {\n  emitter.on(event, fn)\n  return {\n    off: () => emitter.off(event, fn)\n  }\n}\n","export default val => {\n  try {\n    return JSON.parse(val)\n  } catch (error) {\n    return null\n  }\n}\n","export default obj => {\n  try {\n    return JSON.parse(JSON.stringify(obj))\n  } catch (err) {\n    console.log(err)\n    return null\n  }\n}\n","import EventEmitter from 'component-emitter'\nimport Backoff from 'backo'\nimport debug from 'debug'\nimport { validate } from '@rapid-io/protocol'\n\nimport WebSocket from './websocket'\nimport on from './utils/on'\nimport jsonparse from './utils/jsonparse'\nimport jsonprune from './utils/jsonprune'\n\nconst logger = debug('rapid:transport')\n\nexport default class Transport extends EventEmitter {\n  constructor(\n    url,\n    {\n      reconnectDelay = 1000,\n      reconnectDelayMax = 5000,\n      reconnectAttempts = Infinity\n    } = {}\n  ) {\n    super()\n    this.url = url\n    this.reconnectAttempts = reconnectAttempts\n    this.backoff = new Backoff({ min: reconnectDelay, max: reconnectDelayMax })\n    this.readyState = 'closed'\n    this.subs = []\n    this.reconnecting = false\n    this.skipReconnect = false\n    this.connect()\n  }\n\n  open(onopen, onerror) {\n    if (this.readyState === 'open') {\n      return\n    }\n\n    this.cleanup()\n\n    logger('opening %s', this.url)\n    this.ws = new WebSocket(this.url)\n    this.readyState = 'opening'\n    this.skipReconnect = false\n    const opensub = on(this.ws, 'open', () => {\n      this.readyState = 'open'\n      onopen()\n    })\n    const errsub = on(this.ws, 'error', err => {\n      this.readyState = 'closed'\n      onerror(err)\n    })\n    const closeSub = on(this.ws, 'close', () => this.onclose())\n\n    this.subs.push(opensub, errsub, closeSub)\n  }\n\n  send(message) {\n    message = jsonprune(message)\n    const valid = validate.message(message)\n    if (!valid) {\n      logger('trying to send invalid message: %O', message)\n      throw new Error('Invalid message format sending to a server')\n    }\n\n    if (this.readyState === 'open') {\n      this.ws.send(message)\n    } else {\n      logger('cannot send message, websocket is not open - %o', message)\n    }\n  }\n\n  connect() {\n    this.open(\n      () => this.onconnect(),\n      err => {\n        logger('initial connect error %o', err.message)\n        if (!this.reconnecting && this.backoff.attempts === 0) {\n          this.reconnect()\n        }\n      }\n    )\n  }\n\n  reconnect() {\n    const delay = this.backoff.duration()\n    logger('reconnect attempt in %d', delay)\n    this.reconnecting = true\n    const timeout = setTimeout(() => {\n      logger('attempting to reconnect')\n      this.open(\n        () => this.onreconnect(),\n        err => {\n          logger('reconnect unsuccessful, %o', err.message)\n          this.reconnecting = false\n          this.reconnect()\n        }\n      )\n    }, delay)\n\n    this.subs.push({ off: () => clearTimeout(timeout) })\n  }\n\n  onconnect() {\n    logger('websocket opened')\n    this.subs.push(\n      on(this.ws, 'message', msg => this.onmessage(msg)),\n      on(this.ws, 'error', err => this.onerror(err))\n    )\n    this.emit('connected', true)\n    this.emit('connect')\n  }\n\n  onreconnect() {\n    const { attempts } = this.backoff\n    logger('reconnect successful after %d attempts', attempts)\n    this.reconnecting = false\n    this.backoff.reset()\n    this.emit('reconnect')\n    this.subs.push(\n      on(this.ws, 'message', msg => this.onmessage(msg)),\n      on(this.ws, 'close', () => this.onclose()),\n      on(this.ws, 'error', err => this.onerror(err))\n    )\n  }\n\n  onclose() {\n    logger('websocket closed')\n    this.readyState = 'closed'\n    this.emit('connected', false)\n    this.backoff.reset()\n    this.cleanup()\n    if (!this.skipReconnect) {\n      this.reconnect()\n    }\n  }\n\n  onerror(err) {\n    logger('websocket error %o', err)\n    this.ws.close()\n  }\n\n  onmessage(msg) {\n    const parsed = jsonparse(msg)\n    if (parsed === null) {\n      logger('message is not in JSON format')\n    } else {\n      this.emit('event', parsed)\n    }\n  }\n\n  disconnect() {\n    logger('disconnecting')\n    this.skipReconnect = true\n    this.reconnecting = true\n    if (this.readyState === 'opening') {\n      this.cleanup()\n    }\n    this.backoff.reset()\n    this.readyState = 'closed'\n    if (this.ws) {\n      this.ws.close()\n    }\n  }\n\n  cleanup() {\n    this.subs.forEach(sub => sub.off())\n  }\n}\n","/**\n * Remove listeners helper\n * @param {Array} listeners array of unsubscribe functions\n * @return {Object} off function to remove listeners\n */\n\nexport default listeners => ({\n  off() {\n    listeners.forEach(listener => listener.off())\n  }\n})\n","import shortid from 'shortid'\n// import debug from 'debug'\nimport on from './utils/on'\nimport listen from './utils/listen'\n\n// const log = debug('rapid:subscription')\n\nexport default class Subscription {\n  constructor({ io, query = {}, onVal, onErr }) {\n    this.io = io\n    this.id = shortid.generate()\n    this.query = query\n    this.listeners = null\n    this.valueListeners = [onVal]\n    this.errorListeners = onErr ? [onErr] : []\n    this.docs = []\n    this.subscribed = false\n    this.unsubscribed = false\n    this.changes = {\n      added: [],\n      updated: [],\n      removed: []\n    }\n    this.subscribe()\n  }\n\n  subscribe() {\n    this.listeners = listen([\n      on(this.io, 'val', val => this.onvalue(val)),\n      on(this.io, 'upd', upd => this.onupdate(upd)),\n      on(this.io, 'batch', batch => this.onbatch(batch)),\n      on(this.io, 'rm', rm => this.onremove(rm))\n    ])\n  }\n\n  onbatch(batch) {\n    let shouldNotify = false\n    batch.forEach(evt => {\n      if (evt.val) {\n        shouldNotify = true\n        return this.onvalue(evt.val, { batch: true })\n      }\n      if (evt.upd) {\n        shouldNotify = true\n        return this.onupdate(evt.upd, { batch: true })\n      }\n      if (evt.rm) {\n        shouldNotify = true\n        return this.onremove(evt.rm, { batch: true })\n      }\n    })\n    shouldNotify && this.notify()\n  }\n\n  onvalue(value, { batch = false } = {}) {\n    if (value['sub-id'] === this.id) {\n      this.acknowledge(value)\n      this.docs = value.docs\n      this.changes.added.push(...this.docs)\n      !batch && this.notify()\n    }\n  }\n\n  onupdate(update, { batch = false } = {}) {\n    if (update['sub-id'] === this.id) {\n      this.acknowledge(update)\n\n      const docIdx = this.docs.findIndex(doc => doc.id === update.doc.id)\n\n      if (docIdx !== -1) {\n        this.docs[docIdx] = update.doc\n        this.changes.updated.push(update.doc)\n      } else {\n        this.docs.push(update.doc)\n        this.changes.added.push(update.doc)\n      }\n      this.sort()\n      this.checkLimit()\n      !batch && this.notify()\n    }\n  }\n\n  onremove(remove, { batch = false } = {}) {\n    if (remove['sub-id'] === this.id) {\n      this.acknowledge(remove)\n\n      const docIdx = this.docs.findIndex(doc => doc.id === remove.doc.id)\n\n      if (docIdx !== -1) {\n        const removedDoc = this.docs.splice(docIdx, 1)\n        this.changes.removed.push(...removedDoc)\n        !batch && this.notify()\n      }\n    }\n  }\n\n  sort() {\n    this.docs.sort((current, next) => {\n      // eslint-disable-next-line guard-for-in\n      for (const idx in current.skey) {\n        const currentSortkey = current.skey[idx]\n        const nextSortkey = next.skey[idx]\n\n        if (currentSortkey === nextSortkey) {\n          continue\n        }\n\n        const { order } = this.query\n        const ordering = order[Object.keys(order)[0]]\n        // const orderObj = this.query.order[idx]\n        // const ordering = orderObj[Object.keys(orderObj)[0]] // get value of first object key\n\n        if (ordering === 'asc') {\n          return currentSortkey < nextSortkey ? -1 : 1\n        }\n        return currentSortkey < nextSortkey ? 1 : -1\n      }\n\n      const orderObj = this.query.order && this.query.order[0]\n      const ordering = orderObj ? orderObj[Object.keys(orderObj)[0]] : 'asc'\n\n      if (ordering === 'asc') {\n        return current.crt < next.crt ? -1 : 1\n      }\n      return current.crt < next.crt ? 1 : -1\n    })\n  }\n\n  checkLimit() {\n    const { docs } = this\n    const { limit = null } = this.query\n\n    if (limit && docs.length > limit) {\n      const overflow = docs.length - limit\n      docs.splice(-overflow, overflow)\n    }\n  }\n\n  acknowledge(evt) {\n    this.io.acknowledge(evt['evt-id'])\n  }\n\n  notify() {\n    if (!this.unsubscribed) {\n      this.valueListeners.forEach(onVal => {\n        onVal(this.docs, this.changes)\n      })\n      this.changes = {\n        added: [],\n        updated: [],\n        removed: []\n      }\n    }\n  }\n\n  addListeners(onVal, onErr) {\n    onVal && this.valueListeners.push(onVal)\n    onErr && this.errorListeners.push(onErr)\n  }\n\n  unsubscribe(onVal, onErr) {\n    if (onVal) {\n      this.valueListeners = this.valueListeners.filter(fn => fn !== onVal)\n    }\n    if (onErr) {\n      this.errorListeners = this.errorListeners.filter(fn => fn !== onErr)\n    }\n\n    if (isEmpty(this.valueListeners) && isEmpty(this.errorListeners)) {\n      this.unsubscribed = true\n      this.listeners.off()\n    }\n  }\n\n  cancel(err) {\n    this.errorListeners.forEach(onErr => onErr(err))\n    this.listeners.off()\n    this.valueListeners = []\n    this.errorListeners = []\n  }\n\n  set evt(evt) {\n    this._evt = evt\n  }\n\n  get evt() {\n    return this._evt\n  }\n}\n\nfunction isEmpty(arr) {\n  return arr.length === 0\n}\n","/**\n * Creates an acknowledgement event\n * @param {string} evtId event id\n * @return {Object} event\n */\n\nconst ack = evtId => ({\n  ack: {\n    'evt-id': evtId\n  }\n})\n\nexport default ack\n","import shortid from 'shortid'\n\n/**\n * Creates a connect protocol event\n * @return {Object} event\n */\n\nconst con = conId => ({\n  con: {\n    'evt-id': shortid.generate(),\n    'con-id': conId\n  }\n})\n\nexport default con\n","import shortid from 'shortid'\n\n/**\n * Creates a reconnect protocol event\n * @param {string} conId connection id\n * @return {Object} event\n */\n\nconst rec = conId => ({\n  rec: {\n    'evt-id': shortid.generate(),\n    'con-id': conId\n  }\n})\n\nexport default rec\n","/**\n * Creates a disconnect protocol event\n * @return {Object} event\n */\n\nconst dis = () => ({\n  dis: null\n})\n\nexport default dis\n","import shortid from 'shortid'\n\n/**\n *\n * @param {string} colId collection ID\n * @param {string} docId document ID\n * @param {object} body properties to mutate\n * @return {Object} event\n */\n\nconst mut = (colId, docId, body, etag) => ({\n  mut: {\n    'evt-id': shortid.generate(),\n    'col-id': colId,\n    doc: {\n      id: docId,\n      etag,\n      body\n    }\n  }\n})\n\nexport default mut\n","import shortid from 'shortid'\n\n/**\n * Creates a merge protocol event\n * @param {string} colId collection id\n * @param {string} docId documend id\n * @param {object} body properties to merge\n * @return {Object} event\n */\n\nconst mer = (colId, docId, body, etag) => ({\n  mer: {\n    'evt-id': shortid.generate(),\n    'col-id': colId,\n    doc: {\n      id: docId,\n      etag,\n      body\n    }\n  }\n})\n\nexport default mer\n","import shortid from 'shortid'\n\n/**\n * Creates a delete protocol event\n * @param {string} colId collection id\n * @param {string} docId documend id\n * @return {Object} event\n */\n\nconst del = (colId, docId, etag) => ({\n  del: {\n    'evt-id': shortid.generate(),\n    'col-id': colId,\n    doc: {\n      id: docId,\n      etag\n    }\n  }\n})\n\nexport default del\n","import shortid from 'shortid'\n\n/**\n * Creates a fetch protocol event\n * @param {string} ftc fetch id\n * @param {string} colId collection id\n * @param {object=} query query object\n * @return {Object} event\n */\n\nconst ftc = (colId, { filter, order, limit, skip }) => ({\n  ftc: {\n    'evt-id': shortid.generate(),\n    'ftc-id': shortid.generate(),\n    'col-id': colId,\n    filter,\n    order: order && [order],\n    limit,\n    skip\n  }\n})\n\nexport default ftc\n","import shortid from 'shortid'\n\n/**\n * Creates a subscription protocol event\n * @param {string} subId subscription id\n * @param {string} colId collection id\n * @param {object=} query query object\n * @return {Object} event\n */\n\nconst sub = (subId, colId, { filter, order, limit, skip }) => ({\n  sub: {\n    'evt-id': shortid.generate(),\n    'sub-id': subId,\n    'col-id': colId,\n    filter,\n    order: order && [order],\n    limit,\n    skip\n  }\n})\n\nexport default sub\n","import shortid from 'shortid'\n\n/**\n * Creates an unsubscribe protocl event\n * @param {string} subId subscription id\n * @return {Object} event\n */\n\nconst uns = subId => ({\n  uns: {\n    'evt-id': shortid.generate(),\n    'sub-id': subId\n  }\n})\n\nexport default uns\n","import shortid from 'shortid'\n\n/**\n * Creates an autharization protocol event\n * @param {string} authToken authorization token\n * @return {Object} event\n */\n\nconst auth = authToken => ({\n  auth: {\n    'evt-id': shortid.generate(),\n    token: authToken\n  }\n})\n\nexport default auth\n","import shortid from 'shortid'\n\n/**\n * Creates an deauthorization protocol event\n * @return {Object} event\n */\n\nconst deauth = () => ({\n  deauth: {\n    'evt-id': shortid.generate()\n  }\n})\n\nexport default deauth\n","import shortid from 'shortid'\n\n/**\n * Create channel subscription event\n * @param {(String|Object)} chanId channel id\n * @param {String} subId subscription id\n * @returns {Object}\n */\nconst subCh = ({ chanId, subId }) => ({\n  'sub-ch': {\n    'evt-id': shortid(),\n    'chan-id': chanId,\n    'sub-id': subId\n  }\n})\n\nexport default subCh\n","import shortid from 'shortid'\n\n/**\n * Create channel unsubscription event\n * @param {String} subId subscription id\n * @returns {Object}\n */\nconst unsCh = ({ subId }) => ({\n  'uns-ch': {\n    'evt-id': shortid(),\n    'sub-id': subId\n  }\n})\n\nexport default unsCh\n","import shortid from 'shortid'\n\n/**\n * Creates publish event\n * @param {(String|Object)} chanId channel id\n * @param {Object} body channel message\n * @returns {Object}\n */\nconst pub = ({ chanId, body }) => ({\n  pub: {\n    'evt-id': shortid(),\n    'chan-id': chanId,\n    body\n  }\n})\n\nexport default pub\n","/**\n * No operation event\n * @return {Object} event\n */\n\nconst nop = () => ({\n  nop: null\n})\n\nexport default nop\n","/*\n * Protocol events\n */\n\nexport { default as ack } from './ack'\nexport { default as con } from './con'\nexport { default as rec } from './rec'\nexport { default as dis } from './dis'\nexport { default as mut } from './mut'\nexport { default as mer } from './mer'\nexport { default as del } from './del'\nexport { default as ftc } from './ftc'\nexport { default as sub } from './sub'\nexport { default as uns } from './uns'\nexport { default as auth } from './auth'\nexport { default as deauth } from './deauth'\nexport { default as subCh } from './sub-ch'\nexport { default as unsCh } from './uns-ch'\nexport { default as pub } from './pub'\nexport { default as nop } from './nop'\n","export default function isEmpty(array) {\n  return array.length === 0\n}\n","import { subCh, unsCh, pub } from '../protocol'\nimport isEmpty from '../utils/is-empty'\n\nexport default class Channel {\n  constructor({ subId, chanId, connection, remove }) {\n    this.chanId = chanId\n    this.subId = subId\n    this.connection = connection\n    this.remove = remove\n    this.valueListeners = []\n    this.errorListeners = []\n    this.buffer = new Map()\n    this.subscribed = false\n    this.unsubscribed = false\n    this.connect()\n  }\n\n  connect() {\n    if (this.unsubscribed) {\n      this.unsubscribe()\n      return\n    }\n\n    if (!this.subscribed) {\n      const { chanId, subId } = this\n      this.evt = subCh({ chanId, subId })\n      this.connection.send(this.evt)\n    }\n\n    this.buffer.forEach(message => {\n      this.connection.send(message.evt)\n    })\n  }\n\n  unsubscribe() {\n    this.unsubscribed = true\n    this.evt = unsCh({ subId: this.subId })\n    this.connection.send(this.evt)\n  }\n\n  subscribe(onvalue, onerror) {\n    onvalue && this.valueListeners.push(onvalue)\n    onerror && this.errorListeners.push(onerror)\n\n    return () => {\n      this.valueListeners = this.valueListeners.filter(fn => fn !== onvalue)\n      if (isEmpty(this.valueListeners)) {\n        this.unsubscribe()\n        return\n      }\n      this.errorListeners = this.errorListeners.filter(fn => fn !== onerror)\n    }\n  }\n\n  publish(message) {\n    return new Promise((resolve, reject) => {\n      const evt = pub({ chanId: this.chanId, body: message })\n      const evtId = evt.pub['evt-id']\n      this.buffer.set(evtId, { evt, resolve, reject })\n      this.connection.send(evt)\n    })\n  }\n\n  onack(ack) {\n    const evtId = ack['evt-id']\n    if (this.unsubscribed) {\n      const unsEvt = this.evt['uns-ch']\n      if (evtId === unsEvt['evt-id']) {\n        this.remove()\n        return\n      }\n    }\n\n    if (!this.subscribed) {\n      const subEvt = this.evt['sub-ch']\n      if (evtId === subEvt['evt-id']) {\n        this.subscribed = true\n        return\n      }\n    }\n    const message = this.buffer.get(evtId)\n    if (message) {\n      message.resolve()\n      this.buffer.delete(evtId)\n    }\n  }\n\n  onerror(err) {\n    const evtId = err['evt-id']\n    const subEvt = this.evt['sub-ch']\n\n    if (evtId === subEvt['evt-id']) {\n      this.subscribed = false\n      this.cancel(err) // TODO\n      return\n    }\n\n    const message = this.buffer.get(evtId)\n    if (message) {\n      message.reject(err)\n      this.buffer.delete(evtId)\n    }\n  }\n\n  message(mes) {\n    if (!this.unsubscribed) {\n      this.valueListeners.forEach(cb => cb(mes.body))\n    }\n  }\n\n  cancel(err) {\n    this.errorListeners.forEach(cb => cb(err))\n  }\n}\n","import shortid from 'shortid'\n\nimport Channel from './channel'\n\nexport default class Channels {\n  constructor(connection) {\n    this.connection = connection\n    this.channels = new Map()\n    this.connection.on('mes', mes => this.onmessage(mes))\n    this.connection.on('ca-ch', ca => this.oncancel(ca))\n    this.connection.on('ack', ack => this.onack(ack))\n    this.connection.on('err', err => this.onerror(err))\n  }\n\n  find(chanId) {\n    for (const [, channel] of this.channels) {\n      if (channel.chanId === chanId) {\n        return channel\n      }\n    }\n    return null\n  }\n\n  create(chanId) {\n    const subId = shortid()\n    const channel = new Channel({\n      chanId,\n      subId,\n      connection: this.connection,\n      remove: () => this.remove(chanId)\n    })\n    this.channels.set(subId, channel)\n    return channel\n  }\n\n  get(chanId) {\n    const channel = this.find(chanId) || this.create(chanId)\n    return channel \n  }\n\n  subscribe(chanId, onvalue, onerror) {\n    const channel = this.get(chanId)\n    return channel.subscribe(onvalue, onerror)\n  }\n\n  publish(chanId, message) {\n    const channel = this.get(chanId)\n    return channel.publish(message)\n  }\n\n  remove(chanId, onvalue, onerror) {\n    const channel = this.find(chanId)\n    if (channel) {\n      this.channels.delete(channel.subId)\n      onvalue && onvalue()\n      return\n    }\n    onerror &&\n      onerror(new Error(`No subscriptions for channel named: ${chanId}`))\n  }\n\n  connect() {\n    this.channels.forEach(channel => {\n      channel.subscribed = false\n      channel.connect()\n    })\n  }\n\n  reconnect() {\n    this.channels.forEach(channel => channel.connect())\n  }\n\n  onack(ack) {\n    this.channels.forEach(channel => channel.onack(ack))\n  }\n\n  onmessage(mes) {\n    const subId = mes['sub-id']\n    const channel = this.channels.get(subId)\n    if (channel) {\n      channel.message(mes)\n    }\n  }\n\n  oncancel(ca) {\n    const subId = ca['sub-id']\n    const channel = this.channels.get(subId)\n    if (channel) {\n      channel.cancel(new Error('Channel terminated'))\n      this.channels.delete(subId)\n    }\n  }\n\n  onerror(err) {\n    this.channels.forEach(channel => channel.onerror(err))\n  }\n}\n","import on from './utils/on'\n\nexport default class Fetch {\n  constructor({ connection, evt, onValue, onError }) {\n    this.connection = connection\n    this.evt = evt\n    this.onvalue = onValue\n    this.onerror = onError\n    this.acked = false\n    this.listener = on(this.connection, 'res', res => this.onresult(res))\n  }\n\n  onresult(res) {\n    const ftcId = this.evt.ftc['ftc-id']\n    if (ftcId === res['ftc-id']) {\n      this.onvalue(res.docs)\n      this.connection.fetches.delete(this.evt.ftc['evt-id'])\n      this.off()\n    }\n  }\n\n  cancel(err) {\n    this.onerror(err)\n    this.off()\n  }\n\n  off() {\n    this.listener.off()\n  }\n}\n","/*\n * Timer that invokes function after a period of time\n * also has a reset method\n */\n\nexport default class Timer {\n  constructor(fn, delay) {\n    this.fn = fn\n    this.delay = delay\n    this.interval = null\n    this.start()\n  }\n\n  start() {\n    if (!this.interval) {\n      this.interval = setInterval(this.fn, this.delay)\n    }\n  }\n\n  stop() {\n    clearInterval(this.interval)\n    this.interval = null\n  }\n\n  reset() {\n    if (this.interval) {\n      clearInterval(this.interval)\n      this.interval = setInterval(this.fn, this.delay)\n    }\n  }\n}\n","const create = (type, message) =>\n  class extends Error {\n    constructor(param) {\n      super()\n      this.type = type\n      if (param) {\n        this.message = `${message} ${param}`\n      } else {\n        this.message = message\n      }\n    }\n  }\n\nexport const TimeoutError = create(\n  'timeout',\n  'The request could not be completed in a given time:'\n)\n\nexport const PermissionError = create(\n  'permission-denied',\n  'You are trying to access a data you do not have a security permissions to.'\n)\n\nexport const SubscriptionError = create(\n  'subscription-terminated',\n  \"You don't have permissions to be subscribed to collection:\"\n)\n\nexport const EtagConflictError = create(\n  'etag-conflict',\n  'Etag does not match when mutating a document.'\n)\n\nexport const InvalidAuthTokenError = create(\n  'invalid-auth-token',\n  'The authorization token is invalid.'\n)\n\nexport const InvalidIdError = create(\n  'invalid-id',\n  'Only alphanumeric characters, dashes and underscores are allowed. Invalid id:'\n)\n","import EventEmitter from 'component-emitter'\nimport shortid from 'shortid'\nimport debug from 'debug'\nimport sortKeys from 'sort-keys'\n\nimport Transport from './transport'\nimport Subscription from './subscription'\nimport Channels from './channels/channels'\nimport Fetch from './fetch'\nimport * as events from './protocol'\nimport Timer from './utils/timer'\nimport on from './utils/on'\nimport jsonprune from './utils/jsonprune'\nimport { PermissionError, SubscriptionError } from './errors'\n\nconst logger = debug('rapid:connection')\n\nexport default class Connection extends EventEmitter {\n  constructor(url, opts = {}) {\n    super()\n    this.transport = new Transport(url, opts)\n    this.conId = shortid.generate()\n    this.authEvent = null\n    this.subscriptions = new Map()\n    this.channels = new Channels(this)\n    this.fetches = new Map()\n    this.writebuffer = new Map()\n    this.nooptimer = new Timer(() => this.noop(), opts.noopDelay || 45000)\n    this.connected = false\n    this.init()\n  }\n\n  init() {\n    this.subs = [\n      on(this.transport, 'event', evt => this.onevent(evt)),\n      on(this.transport, 'connect', () => this.onconnect()),\n      on(this.transport, 'reconnect', () => this.onreconnect()),\n      on(this.transport, 'connected', state => this.emit('connected', state)),\n      on(this, 'ack', evt => this.onack(evt)),\n      on(this, 'err', evt => this.onerror(evt)),\n      on(this, 'batch', evt => this.onbatch(evt)),\n      on(this, 'ca', evt => this.oncancel(evt)),\n      on(this, 'permission-denied', err => this.onpermissiondenied(err))\n    ]\n  }\n\n  close() {\n    logger('close request')\n    this.subs.forEach(sub => sub.off())\n    this.nooptimer.stop()\n    this.transport.disconnect()\n  }\n\n  onevent(evt) {\n    const key = Object.keys(evt)[0]\n    key !== 'val'\n      ? logger('received event %s - %o', key, evt)\n      : logger('received event %s', key)\n    this.emit(key, evt[key])\n    this.nooptimer.reset()\n  }\n\n  onconnect() {\n    logger('onconnect')\n    this.send(events.con(this.conId))\n    if (this.authEvent) {\n      this.send(this.authEvent)\n    }\n    this.subscriptions.forEach(sub => {\n      sub.subscribed = false\n      this.send(sub.evt)\n    })\n    this.fetches.forEach(ftc => {\n      ftc.acked = false\n      this.send(ftc.evt)\n    })\n    this.flush()\n    this.channels.connect()\n    this.connected = true\n  }\n\n  onreconnect() {\n    logger('onreconnect')\n    if (!this.connected) {\n      this.onconnect()\n      return\n    }\n    this.send(events.rec(this.conId))\n    this.subscriptions.forEach(sub => {\n      if (!sub.subscribed) {\n        this.send(sub.evt)\n      }\n    })\n    this.fetches.forEach(ftc => {\n      if (!ftc.acked) {\n        this.send(ftc.evt)\n      }\n    })\n    this.flush()\n    this.channels.reconnect()\n  }\n\n  onack(evt) {\n    const evtId = evt['evt-id']\n    const removed = this.writebuffer.delete(evtId)\n    if (removed) {\n      return\n    }\n\n    for (const [, val] of this.subscriptions) {\n      if (val.evt.sub['evt-id'] === evtId) {\n        val.subscribed = true\n        return\n      }\n    }\n\n    for (const [, val] of this.fetches) {\n      if (val.evt.ftc['evt-id'] === evtId) {\n        val.acked = true\n        return\n      }\n    }\n  }\n\n  onerror(evt) {\n    switch (evt['err-type']) {\n      case 'connection-terminated':\n        return this.onconnect() // reconnected, but server does not remember anything\n      case 'invalid-auth-token':\n        return this.emit('invalid-auth-token', evt)\n      case 'permission-denied':\n        return this.emit('permission-denied', evt)\n      case 'etag-conflict':\n        return this.emit('etag-conflict', evt)\n      default: {\n        return logger('unkown server error %o', evt)\n      }\n    }\n  }\n\n  onpermissiondenied(err) {\n    const evtId = err['evt-id']\n\n    for (const [key, val] of this.subscriptions) {\n      if (val.evt.sub['evt-id'] === evtId) {\n        val.cancel(new PermissionError())\n        this.subscriptions.delete(key)\n        return\n      }\n    }\n\n    for (const [key, val] of this.fetches) {\n      if (val.evt.ftc['evt-id'] === evtId) {\n        val.cancel(new PermissionError())\n        this.fetches.delete(key)\n        return\n      }\n    }\n  }\n\n  oncancel(evt) {\n    const evtId = evt['evt-id']\n    const subId = evt['sub-id']\n\n    this.acknowledge(evtId)\n\n    for (const [key, val] of this.subscriptions) {\n      if (val.id === subId) {\n        val.cancel(new SubscriptionError())\n        this.subscriptions.delete(key)\n      }\n    }\n  }\n\n  onbatch(batch) {\n    for (const evt of batch) {\n      if (evt.ca) {\n        this.oncancel(evt.ca)\n      }\n      if (evt.res) {\n        this.emit('res', evt.res)\n      }\n    }\n  }\n\n  flush() {\n    this.writebuffer.forEach(evt => this.send(evt))\n  }\n\n  send(evt) {\n    logger('sending event: %o', jsonprune(evt))\n    if (!evt.nop) {\n      this.nooptimer.reset()\n    }\n    this.transport.send(evt)\n  }\n\n  acknowledge(evtId) {\n    const evt = events.ack(evtId)\n    this.send(evt)\n  }\n\n  noop() {\n    const evt = events.nop()\n    this.send(evt)\n  }\n\n  authorize(authToken) {\n    const evt = events.auth(authToken)\n    const evtId = evt.auth['evt-id']\n    this.authEvent = evt\n    this.send(evt)\n\n    return evtId\n  }\n\n  deauthorize() {\n    const evt = events.deauth()\n    const evtId = evt.deauth['evt-id']\n    this.authEvent = null\n    this.writebuffer.set(evtId, evt)\n    this.send(evt)\n\n    return evtId\n  }\n\n  subscribe(colId, query, onVal, onErr) {\n    query = jsonprune(query)\n\n    const id = JSON.stringify(sortKeys({ colId, query }))\n    let subscription\n\n    if (this.subscriptions.has(id)) {\n      subscription = this.subscriptions.get(id)\n      subscription.addListeners(onVal, onErr)\n    } else {\n      subscription = new Subscription({ io: this, query, onVal, onErr })\n      const evt = events.sub(subscription.id, colId, query)\n      subscription.evt = evt\n      this.subscriptions.set(id, subscription)\n      this.send(evt)\n    }\n\n    return () => {\n      subscription.unsubscribe(onVal, onErr)\n      if (subscription.unsubscribed) {\n        this.unsubscribe(subscription.id)\n        this.subscriptions.delete(id)\n      }\n    }\n  }\n\n  unsubscribe(subId) {\n    const evt = events.uns(subId)\n    const evtId = evt['evt-id']\n\n    this.writebuffer.set(evtId, evt)\n    this.send(evt)\n\n    return evtId\n  }\n\n  fetch(colId, query, onValue, onError) {\n    const evt = events.ftc(colId, query)\n    const evtId = evt.ftc['evt-id']\n\n    const fetch = new Fetch({ connection: this, evt, onValue, onError })\n    this.fetches.set(evtId, fetch)\n\n    this.send(evt)\n\n    return evtId\n  }\n\n  mutate(colId, docId, body, etag) {\n    const evt = events.mut(colId, docId, body, etag)\n    const evtId = evt.mut['evt-id']\n\n    this.writebuffer.set(evtId, evt)\n    this.send(evt)\n\n    return evtId\n  }\n\n  merge(colId, docId, body, etag) {\n    const evt = events.mer(colId, docId, body, etag)\n    const evtId = evt.mer['evt-id']\n\n    this.writebuffer.set(evtId, evt)\n    this.send(evt)\n\n    return evtId\n  }\n\n  delete(colId, docId, etag) {\n    const evt = events.del(colId, docId, etag)\n    const evtId = evt.del['evt-id']\n\n    this.writebuffer.set(evtId, evt)\n    this.send(evt)\n\n    return evtId\n  }\n\n  subscribeChannel(chanId, onvalue, onerror) {\n    return this.channels.subscribe(chanId, onvalue, onerror)\n  }\n\n  publishChannel(chanId, message) {\n    return this.channels.publish(chanId, message)\n  }\n\n  removeChannel(chanId, onvalue, onerror) {\n    return this.channels.remove(chanId, onvalue, onerror)\n  }\n}\n","import on from './utils/on'\nimport listen from './utils/listen'\nimport { TimeoutError, PermissionError, EtagConflictError } from './errors'\n\nexport default class Document {\n  constructor(connection, id, colId) {\n    this.connection = connection\n    this.id = id\n    this.colId = colId\n  }\n\n  fetch(onvalue, onerror) {\n    const query = {\n      filter: {\n        and: [{ $id: this.id }]\n      }\n    }\n    const handler = (success, error) => {\n      this.connection.fetch(\n        this.colId,\n        query,\n        docs => success(docs[0] || null),\n        error\n      )\n    }\n    if (onvalue) {\n      return handler(onvalue, onerror)\n    }\n    return new Promise(handler)\n  }\n\n  subscribe(onvalue, onerror) {\n    const query = {\n      filter: {\n        and: [{ $id: this.id }]\n      }\n    }\n    const unsubscribe = this.connection.subscribe(\n      this.colId,\n      query,\n      data => (Array.isArray(data) ? onvalue(data[0] || null) : onvalue(data)),\n      onerror\n    )\n    return { unsubscribe }\n  }\n\n  async execute(handler, callback = () => {}) {\n    const doc = await this.fetch()\n    const body = handler(doc)\n    if (typeof body === 'undefined') {\n      return callback(null, false, null)\n    }\n    try {\n      const etag = doc && { etag: doc.etag }\n      if (body === null) {\n        await this.delete(etag)\n        return callback(null, true, null)\n      }\n      await this.mutate(body, etag)\n      if (!doc) {\n        const newDoc = await this.fetch()\n        return callback(null, true, newDoc)\n      }\n      return callback(null, true, doc)\n    } catch (err) {\n      if (err.type === 'etag-conflict') {\n        return this.execute(handler, callback)\n      }\n      return callback(err, false, null)\n    }\n  }\n\n  mutate(value, callback, opts = {}) {\n    if (typeof callback === 'object') {\n      opts = callback || {}\n      callback = undefined // eslint-disable-line no-undefined\n    }\n    const evtId = this.connection.mutate(this.colId, this.id, value, opts.etag)\n    return this.handleEvent(evtId, callback, opts)\n  }\n\n  merge(value, callback, opts = {}) {\n    if (typeof callback === 'object') {\n      opts = callback || {}\n      callback = undefined // eslint-disable-line no-undefined\n    }\n    const evtId = this.connection.merge(this.colId, this.id, value, opts.etag)\n    return this.handleEvent(evtId, callback, opts)\n  }\n\n  delete(callback, opts = {}) {\n    if (typeof callback === 'object') {\n      opts = callback || {}\n      callback = undefined // eslint-disable-line no-undefined\n    }\n    const evtId = this.connection.delete(this.colId, this.id, opts.etag)\n    return this.handleEvent(evtId, callback, opts)\n  }\n\n  handleEvent(evtId, callback, opts = {}) {\n    const handler = (onSuccess, onError) => {\n      const listeners = listen([\n        on(this.connection, 'ack', ack => {\n          if (ack['evt-id'] === evtId) {\n            listeners.off()\n            onSuccess()\n          }\n        }),\n        on(this.connection, 'permission-denied', err => {\n          if (err['evt-id'] === evtId) {\n            listeners.off()\n            onError(new PermissionError())\n          }\n        }),\n        on(this.connection, 'etag-conflict', err => {\n          if (err['evt-id'] === evtId) {\n            listeners.off()\n            onError(new EtagConflictError())\n          }\n        })\n      ])\n\n      if (opts.timeout) {\n        setTimeout(() => {\n          onError(new TimeoutError(opts.timeout))\n          listeners.off()\n        }, opts.timeout)\n      }\n    }\n\n    if (typeof callback === 'function') {\n      return handler(docs => callback(null, docs), err => callback(err))\n    }\n\n    return new Promise((res, rej) => handler(res, rej))\n  }\n}\n","import { InvalidIdError } from '../errors'\n\nexport default function checkId(id) {\n  if (typeof id !== 'string') {\n    throw new TypeError(`${id} is not type of string`)\n  }\n\n  const re = /^[0-9a-zA-Z_-]+$/\n  const valid = re.test(id)\n\n  if (!valid) {\n    throw new InvalidIdError(id)\n  }\n\n  return true\n}\n","import shortid from 'shortid'\nimport Document from './document'\nimport checkId from './utils/check-id'\n\nexport default class Collection {\n  constructor(connection, id, query = {}) {\n    this.connection = connection\n    this.id = id\n    this.query = query\n  }\n\n  filter(filter) {\n    if (typeof filter !== 'object') {\n      throw new TypeError('Filter must be an object')\n    }\n    if (this.query.filter) {\n      throw new Error(`Filter is already defined on a collection: ${this.id}`)\n    }\n    return new Collection(this.connection, this.id, { ...this.query, filter })\n  }\n\n  order(order) {\n    if (typeof order !== 'object') {\n      throw new TypeError('Order must be an object')\n    }\n    if (this.query.order) {\n      throw new Error(`Order is already defined on a collection: ${this.id}`)\n    }\n    return new Collection(this.connection, this.id, { ...this.query, order })\n  }\n\n  limit(limit) {\n    if (typeof limit !== 'number') {\n      throw new TypeError('Limit must be a number')\n    }\n    if (this.query.limit) {\n      throw new Error(`Limit is already defined on a collection: ${this.id}`)\n    }\n    return new Collection(this.connection, this.id, { ...this.query, limit })\n  }\n\n  skip(skip) {\n    if (typeof skip !== 'number') {\n      throw new TypeError('Skip must be a number')\n    }\n    if (this.query.skip) {\n      throw new Error(`Skip is already defined on a collection: ${this.id}`)\n    }\n    return new Collection(this.connection, this.id, { ...this.query, skip })\n  }\n\n  fetch(onvalue, onerror) {\n    const handler = (success, error) => {\n      this.connection.fetch(this.id, this.query, success, error)\n    }\n    if (onvalue) {\n      return handler(onvalue, onerror)\n    }\n    return new Promise(handler)\n  }\n\n  subscribe(onvalue, onerror) {\n    const unsubscribe = this.connection.subscribe(\n      this.id,\n      this.query,\n      onvalue,\n      onerror\n    )\n    return { unsubscribe }\n  }\n\n  document(docId) {\n    checkId(docId)\n    return new Document(this.connection, docId, this.id)\n  }\n\n  newDocument() {\n    const docId = shortid.generate()\n    return new Document(this.connection, docId, this.id)\n  }\n}\n","export default class Channel {\n  constructor(connection, id) {\n    this.connection = connection\n    this.id = id\n  }\n\n  subscribe(onvalue, onerror) {\n    const unsubscribe = this.connection.subscribeChannel(\n      this.id,\n      onvalue,\n      onerror\n    )\n    return { unsubscribe }\n  }\n\n  publish(message, callback) {\n    const p = this.connection.publishChannel(this.id, message)\n    if (!callback) {\n      return p\n    }\n    return p.then(callback, callback)\n  }\n\n  unsubscribeAll(callback) {\n    const handler = (onsuccess, onerror) =>\n      this.connection.removeChannel(this.id, onsuccess, onerror)\n\n    if (callback) {\n      return handler(callback, callback)\n    }\n    return new Promise(handler)\n  }\n}\n","import on from './on'\n\n/**\n * Event listener helper\n * @param {EventEmitter} emitter source\n * @param {String} event listen\n * @param {Function} fn callback\n * @return {object} object with a 'off' method to remove listener\n */\n\nexport default (emitter, event, evtId, fn) => {\n  const listener = on(emitter, event, evt => {\n    if (evt['evt-id'] === evtId) {\n      listener.off()\n      fn()\n    }\n  })\n}\n","// import debug from 'debug'\nimport base64 from 'base-64'\nimport Connection from './connection'\nimport Collection from './collection'\nimport Channel from './channel'\nimport { InvalidAuthTokenError } from './errors'\nimport on from './utils/on'\nimport once from './utils/once'\nimport listen from './utils/listen'\nimport checkId from './utils/check-id'\n\n// const logger = debug('rapid:main')\n\nexport default class Rapid {\n  constructor(apiKey) {\n    const url = base64.decode(apiKey)\n    this.connection = new Connection(url)\n    this.connected = false\n    this.connection.on('connected', state => {\n      this.connected = state\n    })\n  }\n\n  collection(id) {\n    checkId(id)\n    return new Collection(this.connection, id)\n  }\n\n  channel(id) {\n    checkId(id)\n    return new Channel(this.connection, id)\n  }\n\n  authorize(authToken, callback) {\n    const evtId = this.connection.authorize(authToken)\n\n    if (callback) {\n      const listeners = listen([\n        on(this.connection, 'invalid-auth-token', err => {\n          if (err['evt-id'] === evtId) {\n            listeners.off()\n            return callback(new InvalidAuthTokenError())\n          }\n        }),\n        on(this.connection, 'ack', ack => {\n          if (ack['evt-id'] === evtId) {\n            listeners.off()\n            return callback()\n          }\n        })\n      ])\n    }\n  }\n\n  deauthorize(callback) {\n    const evtId = this.connection.deauthorize()\n    if (callback) {\n      once(this.connection, 'ack', evtId, callback)\n    }\n  }\n\n  disconnect() {\n    this.connection.close()\n  }\n\n  onConnectionStateChanged(callback) {\n    this.connection.on('connected', state => callback(state))\n  }\n}\n","import Rapid from './rapid'\n\nconst cache = new Map()\n\nconst createClient = apiKey => {\n  if (!apiKey) {\n    throw new TypeError('Please provide a valid API key.')\n  }\n\n  const client = cache.get(apiKey)\n\n  if (!client) {\n    const newClient = new Rapid(apiKey)\n    cache.set(apiKey, newClient)\n    return newClient\n  }\n\n  return client\n}\n\nexport default { createClient, clients: cache }\n"],"names":["BrowserWebSocket","global","WebSocket","logger","debug","Emitter","url","opts","perMessageDeflate","protocols","isUsingBrowserWebSocket","Boolean","open","wsUrl","ws","NodeWebSocket","err","emit","addEventListeners","onopen","onmessage","event","data","onclose","onerror","message","readyState","OPEN","Error","send","JSON","stringify","error","CONNECTING","close","CLOSING","CLOSED","emitter","fn","on","off","val","parse","obj","log","Transport","EventEmitter","Infinity","reconnectAttempts","backoff","Backoff","min","reconnectDelay","max","reconnectDelayMax","subs","reconnecting","skipReconnect","connect","cleanup","opensub","errsub","closeSub","push","jsonprune","valid","validate","onconnect","attempts","reconnect","delay","duration","timeout","setTimeout","onreconnect","clearTimeout","msg","reset","parsed","jsonparse","forEach","sub","listeners","listener","Subscription","io","query","onVal","onErr","id","shortid","generate","valueListeners","errorListeners","docs","subscribed","unsubscribed","changes","subscribe","listen","onvalue","upd","onupdate","batch","onbatch","rm","onremove","shouldNotify","evt","notify","value","acknowledge","added","update","docIdx","findIndex","doc","updated","sort","checkLimit","remove","removedDoc","splice","removed","current","next","idx","skey","currentSortkey","nextSortkey","order","ordering","Object","keys","orderObj","crt","limit","length","overflow","filter","isEmpty","_evt","arr","ack","evtId","con","conId","rec","mut","colId","docId","body","etag","mer","del","ftc","skip","subId","uns","auth","authToken","deauth","subCh","chanId","unsCh","pub","nop","array","Channel","connection","buffer","Map","unsubscribe","Promise","resolve","reject","set","unsEvt","subEvt","get","delete","cancel","mes","cb","Channels","channels","ca","oncancel","onack","channel","find","create","publish","Fetch","onValue","onError","acked","res","onresult","ftcId","fetches","Timer","interval","start","setInterval","type","param","TimeoutError","PermissionError","SubscriptionError","EtagConflictError","InvalidAuthTokenError","InvalidIdError","Connection","transport","authEvent","subscriptions","writebuffer","nooptimer","noop","noopDelay","connected","init","onevent","state","onpermissiondenied","stop","disconnect","key","events","flush","sortKeys","subscription","has","addListeners","fetch","Document","$id","handler","success","Array","isArray","callback","mutate","newDoc","execute","undefined","handleEvent","merge","onSuccess","rej","checkId","TypeError","re","test","Collection","subscribeChannel","p","publishChannel","then","onsuccess","removeChannel","Rapid","apiKey","base64","decode","authorize","deauthorize","cache","createClient","client","newClient","clients"],"mappings":"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"}